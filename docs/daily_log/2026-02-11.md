# 2026-02-11 (화) — CI/CD 파이프라인 구현 + AI Hub X-ray 의료영상 통합

---

## 1. CI/CD 파이프라인 구현 `8129762`

**156파일 변경 (+18,618 / -8,629)**

GitHub Actions 기반 CI/CD 파이프라인을 구축하고, 코드 품질 도구를 통합했다.

### 주요 내용
| 항목 | 내용 |
|------|------|
| `.github/workflows/ci.yml` | 122줄 — push/PR 트리거, backend(ruff+pytest) + frontend(ESLint+vitest) |
| `Makefile` | 296줄 — `make lint`, `make test`, `make check` 원커맨드 |
| `ruff.toml` | 57줄 — ruff 0.12.12 설정 (line-length=120, isort, pyflakes) |
| `.coveragerc` | 24줄 — pytest 커버리지 설정 |
| `pytest.ini` | 10줄 — 테스트 경로 + asyncio 설정 |
| `.eslintrc.cjs` | 28줄 — React + TypeScript ESLint |
| `vitest.config.ts` | 19줄 — Vitest 테스트 러너 |

### 테스트 인프라 (신규 19파일)
| 영역 | 파일 수 | 테스트 항목 |
|------|---------|------------|
| 미들웨어 | 4 | CSRF, Audit, Rate Limit, Security Headers |
| 서비스 | 5 | DB Pool, Redis Cache, S3, LLM, SQL Executor |
| API 라우터 | 8 | Health, Auth, NER, Text2SQL, BI, AI Ops, Consent, Governance |
| 통합/E2E | 2 | Datamart DB 연결, Smoke 테스트 |

### 기존 코드 리팩토링
| 변경 | 내용 |
|------|------|
| `ai_services/xiyan_sql/` | `schema.py`(574줄)에서 `schema_data.py`(551줄)로 데이터 분리 |
| `ontology_data.py` | 581줄 → 별도 `_ontology_graph_builder.py`(487줄)로 추출 |
| `semantic_search.py` | 399줄 → `_semantic_data.py`(398줄)로 데이터 분리 |
| helper 모듈 17개 | `_ai_architecture_data`, `_ai_ops_models`, `_ai_safety_patterns` 등 신규 추출 |

---

## 2. CI 수정 4건 `6441c6a` ~ `c42a870`

**1파일 변경 (+13 / -4)**

| 커밋 | 수정 내용 |
|------|----------|
| `6441c6a` | ruff 버전 0.12.12 고정 (최신 호환성 문제) |
| `1b81a16` | grep 파이프 → 명시적 패키지 목록 (CI 안정성) |
| `2c6d850` | PYTHONPATH 추가 — ai_services 모듈 import 해결 |
| `c42a870` | 누락 패키지 추가 — python-pptx, neo4j, duckdb 등 |

---

## 3. AI Hub X-ray 의료영상 데이터 통합 (미커밋)

**29파일 변경 (+776 / -166)**

RFP 요건 "의료 영상, 판독문 등 비정형/반정형 데이터 특화 분석 환경 확보"에 대응하여,
AI Hub "주요질환 이미지 합성데이터(X-ray)" (105,000장, ~38GB, PNG 1024×1024) 통합 파이프라인을 구현했다.

### 신규 파일

| 파일 | 줄 수 | 기능 |
|------|-------|------|
| `data_pipeline/scripts/ingest_xray_aihub.py` | ~230 | ETL 스크립트 — MinIO 업로드 + OMOP imaging_study 적재 |
| `data_portal/src/api/routers/medical_imaging.py` | ~260 | 의료영상 데이터셋 API (5 엔드포인트) |

### ETL 스크립트 (`ingest_xray_aihub.py`)
| 기능 | 내용 |
|------|------|
| 폴더 스캔 | 5개 부위 자동 감지 (ChestPA, Mammography, PNS, FacialBone, Foot) |
| S3 업로드 | MinIO `idp-documents/medical-imaging/xray-synthetic/{부위}/{파일명}` |
| DB 적재 | `imaging_study` 테이블에 메타데이터 INSERT (modality=CR, dataset, file_size 등) |
| 재시작 | `.xray_ingest_progress.json`으로 중단 지점부터 재개 |
| 배치 | `--batch-size 100 --limit 20` 옵션, 진행률 표시 |

### 백엔드 API (`medical_imaging.py`)
| 엔드포인트 | 기능 |
|------------|------|
| `GET /datasets` | 등록 데이터셋 목록 (이미지 수 포함) |
| `GET /datasets/{id}/images` | 이미지 목록 (부위 필터 + 페이지네이션) |
| `GET /datasets/{id}/stats` | 부위별/modality별 통계 |
| `GET /image/{id}` | MinIO에서 원본 이미지 서빙 |
| `GET /image/{id}/thumbnail` | PIL 리사이즈 썸네일 (256px) |

### 프론트엔드 (MedicalNER.tsx 확장)
| 추가 | 내용 |
|------|------|
| Tab 5 "의료영상" | 기존 4개 탭에 신규 탭 추가 |
| 통계 카드 | 전체 이미지 수, 데이터 크기, 부위 수, Modality |
| 부위별 분포 | Progress 바 차트 (클릭→필터 연동) |
| 이미지 그리드 | 4열 썸네일 카드 (Image.PreviewGroup) |
| 상세 모달 | 1024px 원본 + 메타데이터 Descriptions |
| 페이지네이션 | 20장 단위 |

### main.py 수정
- `medical_imaging` 라우터 import 및 등록 (1줄)

---

## 일일 통계

| 구분 | 수치 |
|------|------|
| 커밋 (pushed) | 5건 |
| 파일 변경 (committed) | 156파일 |
| 추가/삭제 (committed) | +18,631 / -8,633 |
| 파일 변경 (uncommitted) | 29파일 |
| 추가/삭제 (uncommitted) | +776 / -166 |
| 신규 테스트 파일 | 19개 |
| 신규 API 엔드포인트 | 5개 (medical-imaging) |
| 신규 ETL 스크립트 | 1개 (ingest_xray_aihub.py) |
