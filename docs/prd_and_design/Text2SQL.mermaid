flowchart TD
    subgraph USER["ðŸ‘¤ ì‚¬ìš©ìž ì§ˆì˜"]
        Q["ìž‘ë…„ ìœ„ì•” í™˜ìž ìˆ˜ ë³´ì—¬ì¤˜"]
    end
    
    subgraph STEP1["Step 1: ì˜ë„ íŒŒì•…"]
        A1["LLM ì§ˆì˜ ë¶„ì„"]
        A2["'í™˜ìž ìˆ˜' = COUNT"]
        A3["'ìž‘ë…„' = 2025ë…„"]
    end
    
    subgraph STEP2["Step 2: ìš©ì–´ í•´ì„ (BizMeta)"]
        B1["'ìœ„ì•”' ê²€ìƒ‰"]
        B2["standard_term: stomach cancer"]
        B3["icd_code: C16"]
        B4["synonyms: gastric cancer, ìœ„ìž¥ì•”"]
        B5["related_tables: cancer_patients, diagnosis"]
    end
    
    subgraph STEP3["Step 3: ìŠ¤í‚¤ë§ˆ ì¡°íšŒ (ITMeta)"]
        C1["cancer_patients í…Œì´ë¸”"]
        C2["patient_id (VARCHAR, PK)"]
        C3["cancer_type (VARCHAR)"]
        C4["diagnosis_date (DATE)"]
        C5["ì—°ê´€: diagnosis (FK: patient_id)"]
    end
    
    subgraph STEP4["Step 4: SQL ìƒì„± (LLM)"]
        D1["Context = ìš©ì–´ + ìŠ¤í‚¤ë§ˆ + ê´€ê³„"]
        D2["SELECT COUNT(*) FROM cancer_patients
        WHERE cancer_type = 'stomach'
        AND YEAR(diagnosis_date) = 2025"]
    end
    
    subgraph STEP5["Step 5: ê²€ì¦ ë° ì‹¤í–‰"]
        E1["SQL ë¬¸ë²• ê²€ì¦"]
        E2["ì‹¤í–‰ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸"]
        E3["âœ… ê²°ê³¼: 12,847"]
    end
    
    Q --> A1
    A1 --> A2 & A3
    A2 & A3 --> B1
    B1 --> B2 & B3 & B4 & B5
    B5 --> C1
    C1 --> C2 & C3 & C4 & C5
    C5 --> D1
    D1 --> D2
    D2 --> E1
    E1 --> E2
    E2 --> E3

    style USER fill:#e3f2fd,stroke:#1976d2
    style STEP1 fill:#fff3e0,stroke:#f57c00
    style STEP2 fill:#e8f5e9,stroke:#388e3c
    style STEP3 fill:#f3e5f5,stroke:#7b1fa2
    style STEP4 fill:#fff8e1,stroke:#fbc02d
    style STEP5 fill:#e0f7fa,stroke:#00838f
    style E3 fill:#c8e6c9,stroke:#2e7d32